<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hyper V2Ray | Premium VPN Solutions</title>
    
    <link rel="icon" type="image/png" href="https://raw.githubusercontent.com/induwara-999/hyper-logo/main/1000199504.png">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
    
    <script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.1.3/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.1.3/firebase-database-compat.js"></script>

    <style>
        :root { 
            --primary: #00d2ff; 
            --secondary: #3a7bd5;
            --bg: #030712; 
            --card: #0f172a; 
            --text: #f8fafc; 
            --border: #1e293b; 
            --gradient: linear-gradient(135deg, #00d2ff 0%, #3a7bd5 100%);
            --danger: #ff4b2b;
        }

        body { margin: 0; font-family: 'Poppins', sans-serif; background: var(--bg); color: var(--text); scroll-behavior: smooth; overflow-x: hidden; }
        .hidden { display: none !important; }

        /* Navbar */
        .navbar { 
            display: flex; justify-content: space-between; align-items: center; 
            padding: 10px 5%; background: rgba(15, 23, 42, 0.95); 
            border-bottom: 1px solid var(--border); position: fixed; top: 0; width: 100%;
            z-index: 1000; backdrop-filter: blur(15px); box-sizing: border-box;
        }
        
        .brand { 
            display: flex; 
            align-items: center; 
            font-family: 'Orbitron', sans-serif; 
            font-size: 1.1rem; 
            color: #fff; 
            cursor: pointer; 
            font-weight: bold; 
        }
        
        #site-logo {
            height: 40px;
            width: auto;
            margin-right: 12px;
            border-radius: 50%;
            border: 1px solid var(--primary);
        }

        .brand span { color: var(--primary); }
        .nav-links button { background: transparent; border: none; color: #94a3b8; padding: 8px 12px; border-radius: 8px; cursor: pointer; transition: 0.3s; font-weight: 600; font-family: 'Orbitron'; font-size: 0.7rem; }
        .nav-links button:hover { color: var(--primary); background: rgba(0, 210, 255, 0.1); }

        .page { padding: 120px 8% 60px; min-height: 80vh; }
        .section-title { font-size: 2.2rem; margin-bottom: 40px; font-family: 'Orbitron'; text-align: center; }
        .section-title span { color: var(--primary); }

        /* Buttons */
        .btn-primary { 
            background: var(--gradient); color: white; padding: 12px 25px; 
            border-radius: 50px; border: none; font-weight: 600; cursor: pointer; 
            display: inline-flex; align-items: center; gap: 10px; transition: 0.4s; font-family: 'Orbitron';
        }
        .btn-primary:hover { transform: translateY(-3px); box-shadow: 0 8px 20px rgba(0, 210, 255, 0.4); }

        /* Layout Grid */
        .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 25px; }
        .plan-card { background: var(--card); padding: 30px; border-radius: 25px; border: 1px solid var(--border); text-align: center; }
        
        /* Table Styles */
        .order-container { background: var(--card); border-radius: 20px; border: 1px solid var(--border); overflow: hidden; margin-top: 20px; overflow-x: auto; }
        .order-table { width: 100%; border-collapse: collapse; text-align: left; min-width: 600px; }
        .order-table th { padding: 15px; background: rgba(30, 41, 59, 0.8); color: var(--primary); font-size: 0.75rem; font-family: 'Orbitron'; }
        .order-table td { padding: 15px; border-bottom: 1px solid var(--border); font-size: 0.85rem; }

        .modal { position: fixed; top:0; left:0; width:100%; height:100%; background: rgba(0,0,0,0.9); display: flex; justify-content: center; align-items: center; z-index: 2000; padding: 20px; box-sizing: border-box; }
        .auth-card { background: var(--card); padding: 35px; border-radius: 25px; width: 100%; max-width: 450px; border: 1px solid var(--border); box-sizing: border-box; }
        .input, .select { width: 100%; padding: 14px; margin: 10px 0; border-radius: 12px; border: 1px solid var(--border); background: #050810; color: white; outline: none; box-sizing: border-box; }
        .pay-box { background: rgba(0, 210, 255, 0.05); padding: 15px; border-radius: 15px; border: 1px dashed var(--primary); margin: 15px 0; font-size: 0.85rem; line-height: 1.6; text-align: left; }
        footer { text-align: center; padding: 40px; border-top: 1px solid var(--border); margin-top: 60px; color: #475569; font-size: 0.8rem; }
    </style>
</head>
<body>

    <nav class="navbar">
        <div class="brand" onclick="showPage('home')">
            <img src="https://raw.githubusercontent.com/induwara-999/hyper-logo/main/1000199504.png" alt="Logo" id="site-logo">
            HYPER<span>V2RAY</span>
        </div>
        <div class="nav-links" id="nav-content"></div>
    </nav>

    <div id="home-page" class="page">
        <div style="text-align: center; margin-bottom: 80px;">
            <h1 style="font-size: 3.5rem; font-family: 'Orbitron'; margin-bottom: 20px;">UNLIMITED FREEDOM<br>BY <span>HYPER V2RAY</span></h1>
            <p style="color: #94a3b8; max-width: 700px; margin: 0 auto 30px;">
                Experience lightning-fast V2Ray connections powered by NovaLink.lk infrastructure.
            </p>
            <button class="btn-primary" onclick="handleGetConnected()">GET STARTED <i class="fas fa-bolt"></i></button>
        </div>
    </div>

    <div id="plans-page" class="page hidden">
        <h2 class="section-title">SELECT <span>PLAN</span></h2>
        <div id="plans-container" class="grid"></div>
    </div>

    <div id="orders-page" class="page hidden">
        <h2 class="section-title">ORDER <span>HISTORY</span></h2>
        <div class="order-container">
            <table class="order-table">
                <thead><tr><th>Email</th><th>Plan</th><th>Package</th><th>Date</th><th>Action</th></tr></thead>
                <tbody id="order-list"></tbody>
            </table>
        </div>
    </div>

    <div id="admin-page" class="page hidden">
        <h2 class="section-title">ADMIN <span>PANEL</span></h2>
        <div class="auth-card" style="margin: auto;">
            <input type="text" id="adm-name" placeholder="Plan Name" class="input">
            <input type="text" id="adm-price" placeholder="Price (LKR)" class="input">
            <select id="adm-valid" class="select">
                <option>1 Month</option><option>3 Months</option><option>1 Year</option>
            </select>
            <textarea id="adm-feats" placeholder="Features (New line)" class="input" rows="3"></textarea>
            <button class="btn-primary" style="width:100%; justify-content: center;" onclick="adminAddPlan()">PUBLISH PLAN</button>
        </div>
    </div>

    <div id="pay-modal" class="modal hidden">
        <div class="auth-card">
            <h3 id="p-plan-name" style="color:var(--primary); font-family: 'Orbitron';"></h3>
            <select id="p-pkg" class="select">
                <option>Dialog-Zoom</option><option>Dialog-348</option><option>SLT-Zoom</option>
                <option>SLT-Netflix</option><option>Hutch-Zoom</option><option>Airtel-260</option>
            </select>
            <div class="pay-box">
                <strong>Pay On Bank ✅</strong><br>SAMPATH BANK: 102453392941<br><br>
                <strong>Pay On Ez Cash ✅</strong><br>0773608163 (+20 LKR)
            </div>
            <button class="btn-primary" style="width:100%; justify-content: center;" onclick="confirmOrder()">CONFIRM & SEND RECEIPT</button>
            <button onclick="closePay()" style="width:100%; background:none; border:none; color:gray; margin-top:10px; cursor:pointer">Cancel</button>
        </div>
    </div>

    <div id="auth-layer" class="modal hidden">
        <div class="auth-card">
            <h2 id="auth-title" style="text-align: center; font-family: 'Orbitron';">LOGIN</h2>
            <div id="login-inputs">
                <input type="email" id="l-email" placeholder="Email" class="input">
                <input type="password" id="l-pass" placeholder="Password" class="input">
                <button class="btn-primary" style="width:100%; justify-content: center;" onclick="handleLogin()">LOGIN</button>
            </div>
            <button onclick="closeAuth()" style="width:100%; background:none; border:none; color:gray; margin-top:10px; cursor:pointer">Close</button>
        </div>
    </div>

    <footer>© 2026 Hyper V2Ray Solutions.</footer>

    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyAZGWJ9szdCc31zzKf54Cjw4kMnYTRqybI",
            authDomain: "hyperv2ray-5ffbc.firebaseapp.com",
            databaseURL: "https://hyperv2ray-5ffbc-default-rtdb.firebaseio.com",
            projectId: "hyperv2ray-5ffbc",
            storageBucket: "hyperv2ray-5ffbc.firebasestorage.app",
            messagingSenderId: "246744243186",
            appId: "1:246744243186:web:7c48ad22abf553385de96b",
            measurementId: "G-ECDHF8QQQZ"
        };

        firebase.initializeApp(firebaseConfig);
        const database = firebase.database();
        const ADMIN_EMAIL = "dinethinduwara999@gmail.com";

        let session = JSON.parse(localStorage.getItem('hy_session')) || null;
        let activePlan;

        window.onload = () => { updateNav(); renderPlans(); };

        function updateNav() {
            const nav = document.getElementById('nav-content');
            if(session) {
                nav.innerHTML = `
                    <button onclick="showPage('home')">HOME</button>
                    <button onclick="showPage('plans')">PLANS</button>
                    ${session.email === ADMIN_EMAIL ? '<button onclick="showPage(\'admin\')">ADMIN</button>' : ''}
                    <button onclick="showPage('orders')">HISTORY</button>
                    <button onclick="logout()">LOGOUT</button>
                `;
            } else {
                nav.innerHTML = `<button onclick="showPage('home')">HOME</button><button onclick="showAuthMode()">LOGIN</button>`;
            }
        }

        function handleLogin() {
            const email = document.getElementById('l-email').value;
            const pass = document.getElementById('l-pass').value;
            if(email === ADMIN_EMAIL && pass === "admin123") {
                session = { name: "ADMIN", email: ADMIN_EMAIL };
                localStorage.setItem('hy_session', JSON.stringify(session));
                location.reload();
            } else { alert("Invalid Admin Login for demo."); }
        }

        function showPage(id) {
            document.querySelectorAll('.page').forEach(p => p.classList.add('hidden'));
            document.getElementById(id + '-page').classList.remove('hidden');
            if(id === 'orders') renderOrders();
        }

        function adminAddPlan() {
            const name = document.getElementById('adm-name').value;
            const price = document.getElementById('adm-price').value;
            const valid = document.getElementById('adm-valid').value;
            const feats = document.getElementById('adm-feats').value.split('\n');
            database.ref('plans/').push({ name, price, valid, feats }).then(() => { alert("Plan Added!"); renderPlans(); });
        }

        function renderPlans() {
            database.ref('plans/').on('value', (snap) => {
                const container = document.getElementById('plans-container');
                let html = '';
                snap.forEach(child => {
                    const p = child.val();
                    html += `<div class="plan-card">
                        <h3>${p.name}</h3><h2 style="color:var(--primary)">Rs. ${p.price}</h2>
                        <button class="btn-primary" onclick="openPay('${p.name}')">BUY NOW</button>
                    </div>`;
                });
                container.innerHTML = html;
            });
        }

        function openPay(name) { activePlan = name; document.getElementById('p-plan-name').innerText = name; document.getElementById('pay-modal').classList.remove('hidden'); }
        function closePay() { document.getElementById('pay-modal').classList.add('hidden'); }
        function showAuthMode() { document.getElementById('auth-layer').classList.remove('hidden'); }
        function closeAuth() { document.getElementById('auth-layer').classList.add('hidden'); }
        function logout() { localStorage.removeItem('hy_session'); location.reload(); }

        function confirmOrder() {
            const pkg = document.getElementById('p-pkg').value;
            const date = new Date().toLocaleString();
            const orderData = { user: session.email, name: session.name, plan: activePlan, pkg, date };
            
            database.ref('orders/').push(orderData).then(() => {
                // ඔබ ඉල්ලූ නව Message Format එක මෙතැන ඇත
                const msg = `*Hyper V2Ray Order!*%0A%0A` +
                            `Customer: ${session.name.toUpperCase()}%0A` +
                            `Plan: ${activePlan}%0A` +
                            `Package: ${pkg}%0A` +
                            `Date: ${date}%0A%0A` +
                            `*User Email: ${session.email}*%0A%0A` +
                            `_I have completed the payment. Sending receipt now._`;

                window.open(`https://wa.me/94766893639?text=${msg}`);
                closePay();
                showPage('orders');
            });
        }

        function renderOrders() {
            database.ref('orders/').on('value', (snap) => {
                const list = document.getElementById('order-list');
                let html = '';
                snap.forEach(child => {
                    const o = child.val();
                    if(session.email === ADMIN_EMAIL || o.user === session.email) {
                        html += `<tr><td>${o.user}</td><td>${o.plan}</td><td>${o.pkg}</td><td>${o.date}</td><td>Paid ✅</td></tr>`;
                    }
                });
                list.innerHTML = html;
            });
        }
    </script>
</body>
</html>